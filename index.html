<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Simple Trackmania-esque Game</title>
  <style>
    /* Basic reset & body background */
    body {
      margin: 0;
      background: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    /* Center the canvas */
    canvas {
      background: #556B2F; /* Dark olive green background to simulate grass */
      display: block;
    }
  </style>
</head>
<body>

<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
// =====================
// Game Setup Variables
// =====================

// Canvas and Context
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// Track settings (a donut-shaped track)
// Center of the track
const trackCenter = { x: canvas.width / 2, y: canvas.height / 2 };
// Radii for the outer and inner boundaries of the track
const outerRadius = 250;
const innerRadius = 120;

// Car object
const car = {
  x: trackCenter.x,
  y: trackCenter.y - 180,  // Start near the outer edge of the track
  angle: Math.PI / 2,       // Facing downward initially
  speed: 0,
  maxSpeed: 5,
  accel: 0.2,
  decel: 0.1,
  friction: 0.05,
  turnSpeed: 0.04,
  width: 20,
  height: 10
};

// Key state tracking
const keys = {};

// ============
// Event Listeners
// ============

window.addEventListener('keydown', (e) => {
  keys[e.key] = true;
});

window.addEventListener('keyup', (e) => {
  keys[e.key] = false;
});

// ============
// Game Functions
// ============

// Update car physics based on key inputs
function updateCar() {
  // Accelerate with up arrow
  if (keys["ArrowUp"]) {
    car.speed += car.accel;
    if (car.speed > car.maxSpeed) car.speed = car.maxSpeed;
  }
  // Brake / reverse with down arrow
  if (keys["ArrowDown"]) {
    car.speed -= car.accel;
    if (car.speed < -car.maxSpeed/2) car.speed = -car.maxSpeed/2;
  }
  // Turn left or right (turning is more effective when moving)
  if (keys["ArrowLeft"]) {
    car.angle -= car.turnSpeed * (car.speed / car.maxSpeed);
  }
  if (keys["ArrowRight"]) {
    car.angle += car.turnSpeed * (car.speed / car.maxSpeed);
  }
  
  // Update position with current speed and direction
  car.x += Math.cos(car.angle) * car.speed;
  car.y += Math.sin(car.angle) * car.speed;
  
  // Apply friction to gradually slow down the car when not accelerating
  if (!keys["ArrowUp"] && !keys["ArrowDown"]) {
    if (car.speed > 0) {
      car.speed -= car.friction;
      if (car.speed < 0) car.speed = 0;
    } else if (car.speed < 0) {
      car.speed += car.friction;
      if (car.speed > 0) car.speed = 0;
    }
  }
  
  // Check if car is off the track
  const dx = car.x - trackCenter.x;
  const dy = car.y - trackCenter.y;
  const distance = Math.sqrt(dx * dx + dy * dy);
  
  // If car is either inside the inner radius or outside the outer radius, simulate collision
  if (distance < innerRadius || distance > outerRadius) {
    car.speed = 0; // Stop the car if it's off-track
  }
}

// Function to draw the track: a ring-shaped road
function drawTrack() {
  // Draw outer circle (road outer boundary)
  ctx.save();
  ctx.translate(trackCenter.x, trackCenter.y);
  // Outer border (simulate road border)
  ctx.beginPath();
  ctx.arc(0, 0, outerRadius, 0, Math.PI * 2);
  ctx.fillStyle = "#888"; // Road color
  ctx.fill();
  
  // Inner circle (grass inside the track)
  ctx.beginPath();
  ctx.arc(0, 0, innerRadius, 0, Math.PI * 2);
  ctx.fillStyle = "#556B2F"; // Grass same as background
  ctx.fill();
  ctx.restore();
}

// Function to draw the car as a simple rotated rectangle
function drawCar() {
  ctx.save();
  ctx.translate(car.x, car.y);
  ctx.rotate(car.angle);
  // Draw the car body (a simple rectangle)
  ctx.fillStyle = "#f00"; // Red car
  ctx.fillRect(-car.width/2, -car.height/2, car.width, car.height);
  
  // Draw a front indicator (a small rectangle or line)
  ctx.fillStyle = "#fff";
  ctx.fillRect(car.width/4, -car.height/4, car.width/4, car.height/2);
  ctx.restore();
}

// Main game loop
function gameLoop() {
  // Clear canvas
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // Redraw background (grass)
  ctx.fillStyle = "#556B2F";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  
  // Update car physics and redraw elements
  updateCar();
  drawTrack();
  drawCar();
  
  requestAnimationFrame(gameLoop);
}

// Start the game loop
requestAnimationFrame(gameLoop);
</script>

</body>
</html>
